{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/FacebookClient/src/pages/conversation/conversation-customer/search-product.tsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { PictureOutlined } from '@ant-design/icons';\nimport { Avatar, Col, Row, Space, message } from 'antd';\nimport { debounce, flatten, get } from 'lodash';\nimport React, { useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { fetchProductsRequest } from '../../../api/product-api';\nimport { Loading } from '../../../components';\nimport { IMG_URL } from '../../../configs/vars';\nimport formatMoney from '../../../utils/format-money';\nimport { useOrder } from './context-order';\nimport './search-product.less';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst ProductRow = ({\n  product\n}) => {\n  _s();\n\n  const {\n    order,\n    setOrder\n  } = useOrder();\n  const outOfStock = !product.quantity || product.quantity === 0;\n\n  const handleClick = () => {\n    if (outOfStock) {\n      return;\n    }\n\n    if (!order.warehouseId) {\n      return message.error('Vui lòng chọn địa chỉ lấy hàng trước khi chọn sản phẩm!');\n    }\n\n    const exist = order.products.find(p => p.productId === product._id);\n\n    if (exist) {\n      const newProducts = order.products.map(p => {\n        if (p.productId === product._id) return { ...p,\n          count: p.count + 1\n        };\n        return p;\n      });\n      const newOrder = { ...order,\n        products: newProducts\n      };\n      setOrder(newOrder);\n    } else {\n      const newProducts = [...order.products, {\n        name: product.name,\n        productId: product._id,\n        count: 1,\n        price: product.price,\n        weight: product.weight,\n        images: product.images\n      }];\n      const newOrder = { ...order,\n        products: newProducts\n      };\n      setOrder(newOrder);\n    }\n  };\n\n  const renderNameAttributes = () => {\n    var _product$attributes;\n\n    if (!product.attributes || ((_product$attributes = product.attributes) === null || _product$attributes === void 0 ? void 0 : _product$attributes.length) === 0) {\n      return null;\n    }\n\n    const attrNames = product.attributes.map(item => get(item, 'tags'));\n    return /*#__PURE__*/_jsxDEV(\"small\", {\n      children: flatten(attrNames).join('-')\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 66,\n      columnNumber: 16\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: outOfStock ? 'product-row disabled' : 'product-row',\n    onClick: handleClick,\n    children: /*#__PURE__*/_jsxDEV(Row, {\n      justify: \"space-between\",\n      align: \"middle\",\n      gutter: 5,\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        flex: 3,\n        children: /*#__PURE__*/_jsxDEV(Space, {\n          children: [product.images.length > 0 ? /*#__PURE__*/_jsxDEV(Avatar, {\n            shape: \"square\",\n            size: 40,\n            src: `${IMG_URL}${product.images[0]}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 79,\n            columnNumber: 29\n          }, this) : /*#__PURE__*/_jsxDEV(Avatar, {\n            shape: \"square\",\n            size: 40,\n            icon: /*#__PURE__*/_jsxDEV(PictureOutlined, {}, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 85,\n              columnNumber: 68\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              children: product.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 29\n            }, this), renderNameAttributes()]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 88,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        flex: 3,\n        style: {\n          textAlign: 'center'\n        },\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"quantity\",\n          children: product.quantity ? formatMoney(product.quantity) : 0\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 96,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 95,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        children: [formatMoney(product.price), \" \\u0111\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 71,\n    columnNumber: 9\n  }, this);\n};\n\n_s(ProductRow, \"A18+GEg8U2eBDRGY95NyxGgKPXA=\", false, function () {\n  return [useOrder];\n});\n\n_c = ProductRow;\n\nconst ProductsList = ({\n  products,\n  loading\n}) => {\n  const renderContent = () => {\n    if (loading) return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: 50\n      },\n      children: /*#__PURE__*/_jsxDEV(Loading, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 17\n    }, this);\n    if (products.length === 0) return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: \"No products\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 43\n    }, this);\n    return products.map(product => /*#__PURE__*/_jsxDEV(ProductRow, {\n      product: product\n    }, product._id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 122,\n      columnNumber: 47\n    }, this));\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"products-list\",\n    children: renderContent()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 125,\n    columnNumber: 12\n  }, this);\n};\n\n_c2 = ProductsList;\n\nconst SearchProduct = () => {\n  _s2();\n\n  const token = useSelector(state => state.auth.token);\n  const store = useSelector(state => state.store.store);\n  const {\n    order\n  } = useOrder();\n  const [isFocus, setIsFocus] = useState(false);\n  const [loading, setLoading] = useState(true);\n  const [products, setProducts] = useState([]);\n\n  const getProducts = async textSearch => {\n    try {\n      setLoading(true);\n      const res = await fetchProductsRequest({\n        token: token.accessToken,\n        storeId: store._id,\n        query: {\n          textSearch,\n          page: 1,\n          limit: 15,\n          withQuantity: true,\n          warehouseId: order.warehouseId\n        }\n      });\n      setProducts(res.data);\n      setLoading(false);\n    } catch (error) {\n      setLoading(false);\n    }\n  };\n\n  const handleChange = e => {\n    const text = e.target.value;\n\n    if (text.length > 0) {\n      searchProduct(text);\n    }\n  };\n\n  const searchProduct = debounce(text => {\n    getProducts(text);\n  }, 300);\n\n  const handleFocus = async () => {\n    setIsFocus(true);\n    getProducts();\n  };\n\n  const handleBlur = () => {\n    setTimeout(() => {\n      setIsFocus(false);\n    }, 300);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"products-search\",\n    children: isFocus && /*#__PURE__*/_jsxDEV(ProductsList, {\n      products: products,\n      loading: loading\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 25\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 183,\n    columnNumber: 9\n  }, this);\n};\n\n_s2(SearchProduct, \"waiegK0Y3jUCHgCi2U8DcLU+E0c=\", false, function () {\n  return [useSelector, useSelector, useOrder];\n});\n\n_c3 = SearchProduct;\nexport default SearchProduct;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"ProductRow\");\n$RefreshReg$(_c2, \"ProductsList\");\n$RefreshReg$(_c3, \"SearchProduct\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/FacebookClient/src/pages/conversation/conversation-customer/search-product.tsx"],"names":["PictureOutlined","Avatar","Col","Row","Space","message","debounce","flatten","get","React","useState","useSelector","fetchProductsRequest","Loading","IMG_URL","formatMoney","useOrder","ProductRow","product","order","setOrder","outOfStock","quantity","handleClick","warehouseId","error","exist","products","find","p","productId","_id","newProducts","map","count","newOrder","name","price","weight","images","renderNameAttributes","attributes","length","attrNames","item","join","textAlign","ProductsList","loading","renderContent","padding","SearchProduct","token","state","auth","store","isFocus","setIsFocus","setLoading","setProducts","getProducts","textSearch","res","accessToken","storeId","query","page","limit","withQuantity","data","handleChange","e","text","target","value","searchProduct","handleFocus","handleBlur","setTimeout"],"mappings":"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","sourcesContent":["import { PictureOutlined } from '@ant-design/icons';\nimport { Avatar, Col, Input, Row, Space, message } from 'antd';\nimport { debounce, flatten, get } from 'lodash';\nimport React, { FC, useState } from 'react';\nimport { useSelector } from 'react-redux';\nimport { fetchProductsRequest } from '../../../api/product-api';\nimport { SearchIcon } from '../../../assets/icon';\nimport { Loading } from '../../../components';\nimport { IMG_URL } from '../../../configs/vars';\nimport formatMoney from '../../../utils/format-money';\nimport { useOrder } from './context-order';\nimport './search-product.less';\n\ninterface ProductRowProps {\n    product: any;\n}\n\nconst ProductRow: FC<ProductRowProps> = ({ product }) => {\n    const { order, setOrder } = useOrder();\n\n    const outOfStock = !product.quantity || product.quantity === 0;\n\n    const handleClick = () => {\n        if (outOfStock) {\n            return;\n        }\n        if (!order.warehouseId) {\n            return message.error('Vui lòng chọn địa chỉ lấy hàng trước khi chọn sản phẩm!');\n        }\n        const exist = order.products.find((p: any) => p.productId === product._id);\n\n        if (exist) {\n            const newProducts = order.products.map((p: any) => {\n                if (p.productId === product._id) return { ...p, count: p.count + 1 };\n                return p;\n            });\n\n            const newOrder = { ...order, products: newProducts };\n\n            setOrder(newOrder);\n        } else {\n            const newProducts = [\n                ...order.products,\n                {\n                    name: product.name,\n                    productId: product._id,\n                    count: 1,\n                    price: product.price,\n                    weight: product.weight,\n                    images: product.images,\n                },\n            ];\n\n            const newOrder = { ...order, products: newProducts };\n            setOrder(newOrder);\n        }\n    };\n\n    const renderNameAttributes = () => {\n        if (!product.attributes || product.attributes?.length === 0) {\n            return null;\n        }\n\n        const attrNames = product.attributes.map((item: any) => get(item, 'tags'));\n\n        return <small>{flatten(attrNames).join('-')}</small>;\n    };\n\n\n    return (\n        <div\n            className={outOfStock ? 'product-row disabled' : 'product-row'}\n            onClick={handleClick}\n        >\n            <Row justify='space-between' align='middle' gutter={5}>\n                <Col flex={3}>\n                    <Space>\n                        {product.images.length > 0 ? (\n                            <Avatar\n                                shape='square'\n                                size={40}\n                                src={`${IMG_URL}${product.images[0]}`}\n                            />\n                        ) : (\n                            <Avatar shape='square' size={40} icon={<PictureOutlined />} />\n                        )}\n\n                        <div>\n                            <div>{product.name}</div>\n\n                            {renderNameAttributes()}\n                        </div>\n                    </Space>\n                </Col>\n                <Col flex={3} style={{ textAlign: 'center' }}>\n                    <span className=\"quantity\">\n                        {product.quantity ? formatMoney(product.quantity) : 0}\n                    </span>\n                </Col>\n                <Col>{formatMoney(product.price)} đ</Col>\n            </Row>\n        </div>\n    );\n};\n\ninterface ProductListProps {\n    products: any[];\n    loading: boolean;\n}\n\nconst ProductsList: FC<ProductListProps> = ({ products, loading }) => {\n    const renderContent = () => {\n        if (loading)\n            return (\n                <div style={{ padding: 50 }}>\n                    <Loading />\n                </div>\n            );\n\n        if (products.length === 0) return <div>No products</div>;\n\n        return products.map((product: any) => <ProductRow key={product._id} product={product} />);\n    };\n\n    return <div className='products-list'>{renderContent()}</div>;\n};\n\nconst SearchProduct: FC = () => {\n    const token = useSelector((state: any) => state.auth.token);\n    const store = useSelector((state: any) => state.store.store);\n\n    const { order } = useOrder();\n\n    const [isFocus, setIsFocus] = useState(false);\n    const [loading, setLoading] = useState(true);\n    const [products, setProducts] = useState<any[]>([]);\n\n    const getProducts = async (textSearch?: string) => {\n        try {\n            setLoading(true);\n            const res = await fetchProductsRequest({\n                token: token.accessToken,\n                storeId: store._id,\n                query: {\n                    textSearch,\n                    page: 1,\n                    limit: 15,\n                    withQuantity: true,\n                    warehouseId: order.warehouseId,\n                },\n            });\n\n            setProducts(res.data);\n            setLoading(false);\n        } catch (error) {\n            setLoading(false);\n        }\n    };\n\n    const handleChange = (e: any) => {\n        const text = e.target.value;\n        if (text.length > 0) {\n            searchProduct(text);\n        }\n    };\n\n    const searchProduct = debounce((text: string) => {\n        getProducts(text);\n    }, 300);\n\n    const handleFocus = async () => {\n        setIsFocus(true);\n        getProducts();\n    };\n\n    const handleBlur = () => {\n        setTimeout(() => {\n            setIsFocus(false);\n        }, 300);\n    };\n\n    return (\n        <div className='products-search'>\n            {/* <Input\n                prefix={<SearchIcon />}\n                placeholder='Tìm kiếm sản phẩm'\n                allowClear\n                onChange={handleChange}\n                onFocus={handleFocus}\n                onBlur={handleBlur}\n                className='input-search'\n                style={{ height: 35 }}\n            /> */}\n\n            {isFocus && <ProductsList products={products} loading={loading} />}\n        </div>\n    );\n};\n\nexport default SearchProduct;\n"]},"metadata":{},"sourceType":"module"}