{"ast":null,"code":"var _jsxFileName = \"/Users/mac3/Desktop/workspace/FacebookClient/src/pages/live-stream/scripts/script-table.tsx\",\n    _s = $RefreshSig$();\n\nimport { FileAddOutlined, QuestionCircleOutlined } from '@ant-design/icons';\nimport { Checkbox, Col, Row, Space, Table, Tooltip } from 'antd';\nimport { isUndefined } from 'lodash';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { DownIcon } from '../../../assets/icon';\nimport { TextEllipsis } from '../../../components';\nimport { changeFilter, loadLivestreams } from '../../../reducers/livestreamState/livestreamAction';\nimport Post from './post';\nimport ScriptCopy from './script-copy';\nimport ScriptTableAction from './script-table-action';\nimport './script-table.less';\nimport SwitchActiveScript from './switch-active-script';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst renderCountNumber = value => isUndefined(value) ? '---' : value;\n\nconst getTitle = status => {\n  switch (status) {\n    case 0:\n      return {\n        color: '#0872d7',\n        label: 'Chưa sử dụng',\n        title: 'Kịch bản chưa được áp dụng cho bài livestream.',\n        styles: \"white-space: nowrap\"\n      };\n\n    case 1:\n      return {\n        color: '#307dd2',\n        label: 'Đang sử dụng',\n        title: 'Kịch bản đang được áp dụng cho bài livestream.'\n      };\n\n    case 2:\n      return {\n        color: '#23ad44',\n        label: 'Đang tạo đơn hàng',\n        title: 'Đang tạo đơn hàng'\n      };\n\n    case 3:\n      return {\n        color: '#23b7e5',\n        label: 'Đang chờ xử lý',\n        title: 'Đang chờ xử lý'\n      };\n\n    default:\n      return {\n        color: '#f05050',\n        label: 'Đã sử dụng',\n        title: 'Kịch bản đã sử dụng'\n      };\n  }\n};\n\nconst columns = [{\n  title: 'Tên kịch bản',\n  dataIndex: '',\n  key: 'name',\n  width: 250,\n  sorter: true,\n  render: script => {\n    return /*#__PURE__*/_jsxDEV(Link, {\n      to: `script/${script.fbPageId}/${script._id}`,\n      className: \"insa-align-center script-link\",\n      children: /*#__PURE__*/_jsxDEV(TextEllipsis, {\n        width: 250,\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          title: script.name,\n          children: script.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 17\n    }, this);\n  }\n}, {\n  title: 'Bài viết',\n  dataIndex: '',\n  key: 'text',\n  width: 210,\n  render: script => {\n    return /*#__PURE__*/_jsxDEV(Post, {\n      script: script\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 20\n    }, this);\n  }\n}, {\n  title: 'Trạng thái',\n  dataIndex: 'status',\n  key: 'status',\n  render: status => {\n    const {\n      label,\n      color,\n      title\n    } = getTitle(status);\n    return /*#__PURE__*/_jsxDEV(Space, {\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: label\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Tooltip, {\n        title: title,\n        style: styles,\n        placement: \"top\",\n        children: /*#__PURE__*/_jsxDEV(QuestionCircleOutlined, {}, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 103,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 17\n    }, this);\n  }\n}, {\n  title: 'Khách hàng',\n  dataIndex: 'customerCount',\n  key: 'customerCount',\n  align: 'center',\n  render: customerCount => renderCountNumber(customerCount)\n}, {\n  title: 'Bình luận',\n  dataIndex: 'commentCount',\n  key: 'commentCount',\n  align: 'center',\n  render: commentCount => renderCountNumber(commentCount)\n}, {\n  title: 'Đơn hàng',\n  dataIndex: 'orderCount',\n  key: 'orderCount',\n  align: 'center',\n  render: orderCount => renderCountNumber(orderCount)\n}, {\n  title: 'Thao tác',\n  dataIndex: '',\n  key: 'actions',\n  align: 'center',\n  width: 90,\n  render: script => {\n    const title = script.active ? 'Ngưng kích hoạt' : 'Kích hoạt';\n    return /*#__PURE__*/_jsxDEV(Row, {\n      gutter: 5,\n      justify: \"space-around\",\n      align: \"middle\",\n      children: [/*#__PURE__*/_jsxDEV(Col, {\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          title: title,\n          children: /*#__PURE__*/_jsxDEV(SwitchActiveScript, {\n            script: script\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 143,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(Col, {\n        children: /*#__PURE__*/_jsxDEV(Tooltip, {\n          title: \"Sao ch\\xE9p k\\u1ECBch b\\u1EA3n\",\n          placement: \"top\",\n          children: /*#__PURE__*/_jsxDEV(\"span\", {\n            children: /*#__PURE__*/_jsxDEV(ScriptCopy, {\n              script: script,\n              children: /*#__PURE__*/_jsxDEV(FileAddOutlined, {\n                style: {\n                  fontSize: 20,\n                  color: '#9f9f9f'\n                }\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 150,\n                columnNumber: 37\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 149,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 17\n    }, this);\n  }\n}, {\n  title: 'Ngày tạo',\n  dataIndex: 'createdAt',\n  align: 'center',\n  width: 100,\n  sorter: true,\n  defaultSortOrder: 'descend',\n  key: 'createdAt',\n  render: createdAt => moment(createdAt).format('DD/MM/YYYY HH:mm')\n}];\n\nconst ScriptTable = props => {\n  _s();\n\n  const dispatch = useDispatch();\n  const scripts = useSelector(state => state.livestream.scripts);\n  const loading = useSelector(state => state.livestream.loading);\n  const total = useSelector(state => state.livestream.total);\n  const limit = useSelector(state => state.livestream.limit);\n  const page = useSelector(state => state.livestream.page);\n  const fbPageId = useSelector(state => state.livestream.fbPageId);\n  const [scripts_select, setScriptsSelect] = useState([]);\n  const [rowSelection, setRowSelection] = useState({\n    onChange: (selectedRowKeys, selectedRows) => {\n      setScriptsSelect(selectedRows);\n    },\n    columnTitle: undefined\n  });\n  useEffect(() => {\n    var _document;\n\n    const antTableHeadEle = (_document = document) === null || _document === void 0 ? void 0 : _document.querySelector('.livestream-list-section .ant-table-thead');\n    var scriptActionsWidth = antTableHeadEle ? antTableHeadEle.clientWidth : 0;\n    setRowSelection({ ...rowSelection,\n      selectedRowKeys: scripts_select.map(i => i === null || i === void 0 ? void 0 : i._id),\n      columnTitle: scripts_select.length > 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"script-actions\",\n        style: {\n          width: scriptActionsWidth\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkbox-section\",\n          children: /*#__PURE__*/_jsxDEV(Checkbox, {\n            indeterminate: scripts_select.length === scripts.length ? false : true,\n            onChange: scripts_select.length === scripts.length ? resetScriptSelect : selectedAllRow,\n            checked: !!scripts_select.length,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"checkbox-next-text\",\n              children: [\"\\u0110\\xE3 ch\\u1ECDn (\", scripts_select.length, \" k\\u1ECBch b\\u1EA3n)\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 214,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 203,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"script-dropdown-action\",\n          children: /*#__PURE__*/_jsxDEV(ScriptTableAction, {\n            scripts: scripts_select,\n            resetScriptSelect: resetScriptSelect\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 219,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"script-actions not-select\",\n        style: {\n          width: 63\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"checkbox-section\",\n          children: [/*#__PURE__*/_jsxDEV(Checkbox, {\n            onChange: scripts_select.length === scripts.length ? resetScriptSelect : selectedAllRow,\n            checked: !!scripts_select.length\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 229,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(DownIcon, {\n            className: \"down-icon-suffix\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 238,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 228,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 21\n      }, this)\n    }); // eslint-disable-next-line\n  }, [scripts_select, scripts]);\n  useEffect(() => {\n    resetScriptSelect();\n  }, [fbPageId]);\n\n  const onChange = async (pagination, filters, sorter) => {\n    const sort = sorter.columnKey;\n    const direction = sorter.order === 'descend' ? 'desc' : sorter.order === 'ascend' ? 'asc' : undefined;\n    await dispatch(changeFilter({\n      sort,\n      direction,\n      page,\n      limit\n    }));\n    await dispatch(loadLivestreams());\n  };\n\n  const resetScriptSelect = () => {\n    setScriptsSelect([]);\n  };\n\n  const selectedAllRow = () => {\n    setScriptsSelect(scripts);\n  };\n\n  const renderFooter = currentPageData => {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"table-footer\",\n      children: [\"Hi\\u1EC3n th\\u1ECB k\\u1EBFt qu\\u1EA3 t\\u1EEB \", (page - 1) * limit + 1, \" -\", ' ', page * limit > total ? total : page * limit, \" trong t\\u1ED5ng \", total]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 276,\n      columnNumber: 13\n    }, this);\n  };\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Table, {\n      size: \"middle\",\n      columns: columns,\n      dataSource: scripts,\n      rowSelection: {\n        type: 'checkbox',\n        ...rowSelection\n      },\n      rowKey: item => item._id,\n      onChange: onChange,\n      sortDirections: ['ascend', 'descend'],\n      loading: loading,\n      pagination: false,\n      rowClassName: (record, index) => index % 2 !== 0 ? 'table-row-dark' : 'table-row-light',\n      footer: renderFooter\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 285,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n};\n\n_s(ScriptTable, \"82hdtJ/UTQCzvIsW7sw7Teg7Uvs=\", false, function () {\n  return [useDispatch, useSelector, useSelector, useSelector, useSelector, useSelector, useSelector];\n});\n\n_c = ScriptTable;\nexport default ScriptTable;\n\nvar _c;\n\n$RefreshReg$(_c, \"ScriptTable\");","map":{"version":3,"sources":["/Users/mac3/Desktop/workspace/FacebookClient/src/pages/live-stream/scripts/script-table.tsx"],"names":["FileAddOutlined","QuestionCircleOutlined","Checkbox","Col","Row","Space","Table","Tooltip","isUndefined","moment","React","useEffect","useState","useDispatch","useSelector","Link","DownIcon","TextEllipsis","changeFilter","loadLivestreams","Post","ScriptCopy","ScriptTableAction","SwitchActiveScript","renderCountNumber","value","getTitle","status","color","label","title","styles","columns","dataIndex","key","width","sorter","render","script","fbPageId","_id","name","align","customerCount","commentCount","orderCount","active","fontSize","defaultSortOrder","createdAt","format","ScriptTable","props","dispatch","scripts","state","livestream","loading","total","limit","page","scripts_select","setScriptsSelect","rowSelection","setRowSelection","onChange","selectedRowKeys","selectedRows","columnTitle","undefined","antTableHeadEle","document","querySelector","scriptActionsWidth","clientWidth","map","i","length","resetScriptSelect","selectedAllRow","pagination","filters","sort","columnKey","direction","order","renderFooter","currentPageData","type","item","record","index"],"mappings":"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","sourcesContent":["import { FileAddOutlined, QuestionCircleOutlined } from '@ant-design/icons';\nimport { Checkbox, Col, Row, Space, Table, Tooltip } from 'antd';\nimport { ColumnsType, TablePaginationConfig } from 'antd/lib/table';\nimport { isUndefined } from 'lodash';\nimport moment from 'moment';\nimport React, { useEffect, useState } from 'react';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { Link } from 'react-router-dom';\nimport { DownIcon } from '../../../assets/icon';\nimport { TextEllipsis } from '../../../components';\nimport { changeFilter, loadLivestreams } from '../../../reducers/livestreamState/livestreamAction';\nimport Post from './post';\nimport ScriptCopy from './script-copy';\nimport ScriptTableAction from './script-table-action';\nimport './script-table.less';\nimport SwitchActiveScript from './switch-active-script';\n\nconst renderCountNumber = (value?: number) => (isUndefined(value) ? '---' : value);\n\nconst getTitle = (status: number): { label: string; title: string; color: string, styles?: any } => {\n    switch (status) {\n        case 0:\n            return {\n                color: '#0872d7',\n                label: 'Chưa sử dụng',\n                title: 'Kịch bản chưa được áp dụng cho bài livestream.',\n                styles: \"white-space: nowrap\",\n            };\n        case 1:\n            return {\n                color: '#307dd2',\n                label: 'Đang sử dụng',\n                title: 'Kịch bản đang được áp dụng cho bài livestream.',\n            };\n        case 2:\n            return {\n                color: '#23ad44',\n                label: 'Đang tạo đơn hàng',\n                title: 'Đang tạo đơn hàng',\n            };\n\n        case 3:\n            return {\n                color: '#23b7e5',\n                label: 'Đang chờ xử lý',\n                title: 'Đang chờ xử lý',\n            };\n        default:\n            return {\n                color: '#f05050',\n                label: 'Đã sử dụng',\n                title: 'Kịch bản đã sử dụng',\n            };\n    }\n};\n\nconst columns: ColumnsType<any> = [\n    {\n        title: 'Tên kịch bản',\n        dataIndex: '',\n        key: 'name',\n        width: 250,\n        sorter: true,\n\n        render: (script: any) => {\n            return (\n                <Link\n                    to={`script/${script.fbPageId}/${script._id}`}\n                    className='insa-align-center script-link'\n                >\n                    <TextEllipsis width={250}>\n                        <Tooltip title={script.name}>{script.name}</Tooltip>\n                    </TextEllipsis>\n                </Link>\n            );\n        },\n    },\n\n    {\n        title: 'Bài viết',\n        dataIndex: '',\n        key: 'text',\n\n        width: 210,\n        render: (script: any) => {\n            return <Post script={script} />;\n        },\n    },\n    {\n        title: 'Trạng thái',\n        dataIndex: 'status',\n        key: 'status',\n        render: (status: number) => {\n            const { label, color, title } = getTitle(status);\n            return (\n                <Space>\n                    <span>{label}</span>\n                    <Tooltip\n                        title={title}\n                        style={styles}\n                        placement='top'\n                    >\n                        <QuestionCircleOutlined />\n                    </Tooltip>\n                </Space>\n            );\n        },\n    },\n    {\n        title: 'Khách hàng',\n        dataIndex: 'customerCount',\n        key: 'customerCount',\n        align: 'center',\n        render: (customerCount) => renderCountNumber(customerCount),\n    },\n    {\n        title: 'Bình luận',\n        dataIndex: 'commentCount',\n        key: 'commentCount',\n        align: 'center',\n        render: (commentCount) => renderCountNumber(commentCount),\n    },\n    {\n        title: 'Đơn hàng',\n        dataIndex: 'orderCount',\n        key: 'orderCount',\n        align: 'center',\n        render: (orderCount) => renderCountNumber(orderCount),\n    },\n    {\n        title: 'Thao tác',\n        dataIndex: '',\n        key: 'actions',\n        align: 'center',\n        width: 90,\n        render: (script) => {\n            const title = script.active ? 'Ngưng kích hoạt' : 'Kích hoạt';\n\n            return (\n                <Row gutter={5} justify='space-around' align='middle'>\n                    <Col>\n                        <Tooltip title={title}>\n                            <SwitchActiveScript script={script} />\n                        </Tooltip>\n                    </Col>\n                    <Col>\n                        <Tooltip title='Sao chép kịch bản' placement='top'>\n                            <span>\n                                <ScriptCopy script={script}>\n                                    <FileAddOutlined style={{ fontSize: 20, color: '#9f9f9f' }} />\n                                </ScriptCopy>\n                            </span>\n                        </Tooltip>\n                    </Col>\n                </Row>\n            );\n        },\n    },\n    {\n        title: 'Ngày tạo',\n        dataIndex: 'createdAt',\n        align: 'center',\n        width: 100,\n        sorter: true,\n        defaultSortOrder: 'descend',\n        key: 'createdAt',\n        render: (createdAt) => moment(createdAt).format('DD/MM/YYYY HH:mm'),\n    },\n];\n\ninterface Props {}\n\nconst ScriptTable = (props: Props) => {\n    const dispatch = useDispatch();\n    const scripts = useSelector((state: any) => state.livestream.scripts);\n    const loading = useSelector((state: any) => state.livestream.loading);\n    const total = useSelector((state: any) => state.livestream.total);\n    const limit = useSelector((state: any) => state.livestream.limit);\n    const page = useSelector((state: any) => state.livestream.page);\n    const fbPageId = useSelector((state: any) => state.livestream.fbPageId);\n\n    const [scripts_select, setScriptsSelect] = useState([]);\n    const [rowSelection, setRowSelection] = useState<any>({\n        onChange: (selectedRowKeys: any, selectedRows: any) => {\n            setScriptsSelect(selectedRows);\n        },\n        columnTitle: undefined,\n    });\n\n    useEffect(() => {\n        const antTableHeadEle: HTMLTableHeaderCellElement | null = document?.querySelector(\n            '.livestream-list-section .ant-table-thead'\n        );\n        var scriptActionsWidth: number = antTableHeadEle ? antTableHeadEle.clientWidth : 0;\n\n        setRowSelection({\n            ...rowSelection,\n            selectedRowKeys: scripts_select.map((i: any) => i?._id),\n            columnTitle:\n                scripts_select.length > 0 ? (\n                    <div className='script-actions' style={{ width: scriptActionsWidth }}>\n                        <div className='checkbox-section'>\n                            <Checkbox\n                                indeterminate={\n                                    scripts_select.length === scripts.length ? false : true\n                                }\n                                onChange={\n                                    scripts_select.length === scripts.length\n                                        ? resetScriptSelect\n                                        : selectedAllRow\n                                }\n                                checked={!!scripts_select.length}\n                            >\n                                <span className='checkbox-next-text'>\n                                    Đã chọn ({scripts_select.length} kịch bản)\n                                </span>\n                            </Checkbox>\n                        </div>\n                        <div className='script-dropdown-action'>\n                            <ScriptTableAction\n                                scripts={scripts_select}\n                                resetScriptSelect={resetScriptSelect}\n                            />\n                        </div>\n                    </div>\n                ) : (\n                    <div className='script-actions not-select' style={{ width: 63 }}>\n                        <div className='checkbox-section'>\n                            <Checkbox\n                                onChange={\n                                    scripts_select.length === scripts.length\n                                        ? resetScriptSelect\n                                        : selectedAllRow\n                                }\n                                checked={!!scripts_select.length}\n                            />\n\n                            <DownIcon className='down-icon-suffix' />\n                        </div>\n                    </div>\n                ),\n        });\n\n        // eslint-disable-next-line\n    }, [scripts_select, scripts]);\n\n    useEffect(() => {\n        resetScriptSelect();\n    }, [fbPageId]);\n\n    const onChange = async (pagination: TablePaginationConfig, filters: any, sorter: any) => {\n        const sort = sorter.columnKey;\n        const direction =\n            sorter.order === 'descend' ? 'desc' : sorter.order === 'ascend' ? 'asc' : undefined;\n\n        await dispatch(\n            changeFilter({\n                sort,\n                direction,\n                page,\n                limit,\n            })\n        );\n        await dispatch(loadLivestreams());\n    };\n\n    const resetScriptSelect = () => {\n        setScriptsSelect([]);\n    };\n    const selectedAllRow = () => {\n        setScriptsSelect(scripts);\n    };\n\n    const renderFooter = (currentPageData: any) => {\n        return (\n            <div className='table-footer'>\n                Hiển thị kết quả từ {(page - 1) * limit + 1} -{' '}\n                {page * limit > total ? total : page * limit} trong tổng {total}\n            </div>\n        );\n    };\n\n    return (\n        <>\n            <Table\n                size='middle'\n                columns={columns}\n                dataSource={scripts}\n                rowSelection={{\n                    type: 'checkbox',\n                    ...rowSelection,\n                }}\n                rowKey={(item) => item._id}\n                onChange={onChange}\n                sortDirections={['ascend', 'descend']}\n                loading={loading}\n                pagination={false}\n                rowClassName={(record, index) =>\n                    index % 2 !== 0 ? 'table-row-dark' : 'table-row-light'\n                }\n                footer={renderFooter}\n            />\n        </>\n    );\n};\n\nexport default ScriptTable;\n"]},"metadata":{},"sourceType":"module"}